{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.8.7", "generated_at": "2024-10-03T23:35:25.190554Z", "invocation_id": "bb411cc4-dfe1-4874-af03-8f4a53377b16", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2024-10-03T23:34:38.156513Z", "completed_at": "2024-10-03T23:34:38.179911Z"}, {"name": "execute", "started_at": "2024-10-03T23:34:38.180803Z", "completed_at": "2024-10-03T23:34:40.720677Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 2.569614887237549, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.vendas_dbt.bronze_vendas", "compiled": true, "compiled_code": "\n\nSELECT \n    * \nFROM \n    \"crmdatabase_92cf\".\"public\".\"vendas\"", "relation_name": "\"crmdatabase_92cf\".\"public\".\"bronze_vendas\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-10-03T23:34:40.735971Z", "completed_at": "2024-10-03T23:34:40.741862Z"}, {"name": "execute", "started_at": "2024-10-03T23:34:40.742727Z", "completed_at": "2024-10-03T23:34:42.982324Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 2.2503104209899902, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.vendas_dbt.silver_vendas", "compiled": true, "compiled_code": "\nWITH cleaned_data AS (\n    SELECT \n        UPPER(email) as email, \n        DATE(data) AS data,\n        ROUND(CAST(valor AS DECIMAL(10,2)), 2) as valor, \n        quantidade, \n        LOWER(produto) as produto\n    FROM \n        \"crmdatabase_92cf\".\"public\".\"bronze_vendas\"\n    WHERE \n        valor > 349\n        AND valor < 900\n        AND data <= CURRENT_DATE\n)\n\nSELECT * FROM cleaned_data", "relation_name": "\"crmdatabase_92cf\".\"public\".\"silver_vendas\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-10-03T23:34:43.000593Z", "completed_at": "2024-10-03T23:34:43.008695Z"}, {"name": "execute", "started_at": "2024-10-03T23:34:43.009528Z", "completed_at": "2024-10-03T23:34:45.212772Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 2.2165544033050537, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.vendas_dbt.average_products_per_sale", "compiled": true, "compiled_code": "\n\n-- KPI: Quantidade M\u00e9dia de Produtos por Venda\n-- Calcula a quantidade m\u00e9dia de produtos vendidos por venda.\n\nSELECT\n    AVG(quantidade) AS average_products_per_sale\nFROM\n    \"crmdatabase_92cf\".\"public\".\"silver_vendas\"", "relation_name": "\"crmdatabase_92cf\".\"public\".\"average_products_per_sale\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-10-03T23:34:45.221785Z", "completed_at": "2024-10-03T23:34:45.227305Z"}, {"name": "execute", "started_at": "2024-10-03T23:34:45.228158Z", "completed_at": "2024-10-03T23:34:47.399005Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 2.180936336517334, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.vendas_dbt.average_sale_value", "compiled": true, "compiled_code": "\n\n-- KPI: Valor M\u00e9dio da Venda\n-- Calcula o valor m\u00e9dio das vendas.\n\nSELECT\n    AVG(valor) AS average_sale_value\nFROM\n    \"crmdatabase_92cf\".\"public\".\"silver_vendas\"", "relation_name": "\"crmdatabase_92cf\".\"public\".\"average_sale_value\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-10-03T23:34:47.414840Z", "completed_at": "2024-10-03T23:34:47.420962Z"}, {"name": "execute", "started_at": "2024-10-03T23:34:47.421846Z", "completed_at": "2024-10-03T23:34:49.675785Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 2.266491174697876, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.vendas_dbt.average_ticket", "compiled": true, "compiled_code": "\n\n-- KPI: Ticket M\u00e9dio\n-- Calcula o valor m\u00e9dio das compras realizadas pelos clientes.\n\nSELECT\n    AVG(valor) AS average_ticket\nFROM\n    \"crmdatabase_92cf\".\"public\".\"silver_vendas\"", "relation_name": "\"crmdatabase_92cf\".\"public\".\"average_ticket\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-10-03T23:34:49.693386Z", "completed_at": "2024-10-03T23:34:49.701117Z"}, {"name": "execute", "started_at": "2024-10-03T23:34:49.701954Z", "completed_at": "2024-10-03T23:34:51.923139Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 2.235431671142578, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.vendas_dbt.best_selling_product_quantity", "compiled": true, "compiled_code": "\n\n-- KPI: Produto Mais Vendido (em Quantidade)\n-- Encontra o produto com maior quantidade de unidades vendidas.\n\nSELECT\n    produto,\n    SUM(quantidade) AS total_product_quantity\nFROM\n    \"crmdatabase_92cf\".\"public\".\"silver_vendas\"\nGROUP BY\n    produto\nORDER BY\n    total_product_quantity DESC\nLIMIT 1", "relation_name": "\"crmdatabase_92cf\".\"public\".\"best_selling_product_quantity\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-10-03T23:34:51.940157Z", "completed_at": "2024-10-03T23:34:51.948559Z"}, {"name": "execute", "started_at": "2024-10-03T23:34:51.949462Z", "completed_at": "2024-10-03T23:34:54.213842Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 2.2788991928100586, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.vendas_dbt.best_selling_product_value", "compiled": true, "compiled_code": "\n\n-- KPI: Produto Mais Vendido (em Valor)\n-- Encontra o produto que gerou o maior valor de vendas.\n\nSELECT\n    produto,\n    SUM(valor) AS total_product_revenue\nFROM\n    \"crmdatabase_92cf\".\"public\".\"silver_vendas\"\nGROUP BY\n    produto\nORDER BY\n    total_product_revenue DESC\nLIMIT 1", "relation_name": "\"crmdatabase_92cf\".\"public\".\"best_selling_product_value\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-10-03T23:34:54.229814Z", "completed_at": "2024-10-03T23:34:54.239592Z"}, {"name": "execute", "started_at": "2024-10-03T23:34:54.241450Z", "completed_at": "2024-10-03T23:34:56.462201Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 2.2378976345062256, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.vendas_dbt.product_revenue", "compiled": true, "compiled_code": "\n\n-- KPI: Receita por Produto\n-- Calcula o faturamento total gerado por cada produto.\n\nSELECT\n    produto,\n    SUM(valor) AS product_revenue\nFROM\n    \"crmdatabase_92cf\".\"public\".\"silver_vendas\"\nGROUP BY\n    produto", "relation_name": "\"crmdatabase_92cf\".\"public\".\"product_revenue\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-10-03T23:34:56.477515Z", "completed_at": "2024-10-03T23:34:56.483284Z"}, {"name": "execute", "started_at": "2024-10-03T23:34:56.484238Z", "completed_at": "2024-10-03T23:34:58.771701Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 2.2989721298217773, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.vendas_dbt.revenue_per_day", "compiled": true, "compiled_code": "\n\n-- KPI: Faturamento por Dia\n-- Calcula o faturamento total gerado em cada dia.\n\nSELECT\n    DATE(data) AS revenue_date,\n    SUM(valor) AS revenue_per_day\nFROM\n    \"crmdatabase_92cf\".\"public\".\"silver_vendas\"\nGROUP BY\n    revenue_date", "relation_name": "\"crmdatabase_92cf\".\"public\".\"revenue_per_day\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-10-03T23:34:58.787131Z", "completed_at": "2024-10-03T23:34:58.792791Z"}, {"name": "execute", "started_at": "2024-10-03T23:34:58.793620Z", "completed_at": "2024-10-03T23:35:01.049937Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 2.266889810562134, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.vendas_dbt.revenue_per_month", "compiled": true, "compiled_code": "\n\n-- KPI: Faturamento por M\u00eas\n-- Calcula o faturamento total gerado em cada m\u00eas.\n\nSELECT\n    EXTRACT(MONTH FROM data) AS revenue_month,\n    SUM(valor) AS revenue_per_month\nFROM\n    \"crmdatabase_92cf\".\"public\".\"silver_vendas\"\nGROUP BY\n    revenue_month\nORDER BY\n    revenue_month ASC", "relation_name": "\"crmdatabase_92cf\".\"public\".\"revenue_per_month\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-10-03T23:35:01.065505Z", "completed_at": "2024-10-03T23:35:01.076179Z"}, {"name": "execute", "started_at": "2024-10-03T23:35:01.077755Z", "completed_at": "2024-10-03T23:35:03.306267Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 2.248687982559204, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.vendas_dbt.revenue_per_salesperson", "compiled": true, "compiled_code": "\n\n-- KPI: Faturamento por Vendedor\n-- Calcula o valor total de vendas gerado por cada vendedor.\n\nSELECT\n    email,\n    SUM(valor) AS revenue_per_salesperson\nFROM\n    \"crmdatabase_92cf\".\"public\".\"silver_vendas\"\nGROUP BY\n    email\nORDER BY\n    revenue_per_salesperson DESC", "relation_name": "\"crmdatabase_92cf\".\"public\".\"revenue_per_salesperson\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-10-03T23:35:03.322768Z", "completed_at": "2024-10-03T23:35:03.334786Z"}, {"name": "execute", "started_at": "2024-10-03T23:35:03.336629Z", "completed_at": "2024-10-03T23:35:05.607540Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 2.2905471324920654, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.vendas_dbt.revenue_per_year", "compiled": true, "compiled_code": "\n\n-- KPI: Faturamento por Ano\n-- Calcula o faturamento total gerado em cada ano.\n\nSELECT\n    EXTRACT(YEAR FROM data) AS revenue_year,\n    SUM(valor) AS revenue_per_year\nFROM\n    \"crmdatabase_92cf\".\"public\".\"silver_vendas\"\nGROUP BY\n    revenue_year", "relation_name": "\"crmdatabase_92cf\".\"public\".\"revenue_per_year\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-10-03T23:35:05.624667Z", "completed_at": "2024-10-03T23:35:05.631633Z"}, {"name": "execute", "started_at": "2024-10-03T23:35:05.632493Z", "completed_at": "2024-10-03T23:35:07.945842Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 2.3264529705047607, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.vendas_dbt.sales_per_day", "compiled": true, "compiled_code": "\n\n-- KPI: Vendas por Dia\n-- Calcula o n\u00famero de vendas realizadas em cada dia.\n\nSELECT\n    DATE(data) AS sales_date,\n    COUNT(*) AS sales_per_day\nFROM\n    \"crmdatabase_92cf\".\"public\".\"silver_vendas\"\nGROUP BY\n    sales_date\nORDER BY\n    sales_date ASC", "relation_name": "\"crmdatabase_92cf\".\"public\".\"sales_per_day\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-10-03T23:35:07.961343Z", "completed_at": "2024-10-03T23:35:07.968963Z"}, {"name": "execute", "started_at": "2024-10-03T23:35:07.969781Z", "completed_at": "2024-10-03T23:35:10.180204Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 2.2241439819335938, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.vendas_dbt.sales_per_month", "compiled": true, "compiled_code": "\n\n-- KPI: Vendas por M\u00eas\n-- Calcula o n\u00famero de vendas realizadas em cada m\u00eas.\n\nSELECT\n    EXTRACT(MONTH FROM data) AS sales_month,\n    COUNT(*) AS sales_per_month\nFROM\n    \"crmdatabase_92cf\".\"public\".\"silver_vendas\"\nGROUP BY\n    sales_month\nORDER BY\n    sales_month ASC", "relation_name": "\"crmdatabase_92cf\".\"public\".\"sales_per_month\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-10-03T23:35:10.191627Z", "completed_at": "2024-10-03T23:35:10.199714Z"}, {"name": "execute", "started_at": "2024-10-03T23:35:10.200548Z", "completed_at": "2024-10-03T23:35:12.402237Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 2.2144529819488525, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.vendas_dbt.sales_per_salesperson", "compiled": true, "compiled_code": "\n\n-- KPI: N\u00famero de Vendas por Vendedor\n-- Calcula a quantidade de vendas realizadas por cada vendedor.\n\nSELECT\n    email,\n    COUNT(*) AS sales_per_salesperson\nFROM\n    \"crmdatabase_92cf\".\"public\".\"silver_vendas\"\nGROUP BY\n    email", "relation_name": "\"crmdatabase_92cf\".\"public\".\"sales_per_salesperson\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-10-03T23:35:12.413157Z", "completed_at": "2024-10-03T23:35:12.419040Z"}, {"name": "execute", "started_at": "2024-10-03T23:35:12.419935Z", "completed_at": "2024-10-03T23:35:14.666674Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 2.257270336151123, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.vendas_dbt.sales_per_year", "compiled": true, "compiled_code": "\n\n-- KPI: Vendas por Ano\n-- Calcula o n\u00famero de vendas realizadas em cada ano.\n\nSELECT\n    EXTRACT(YEAR FROM data) AS sales_year,\n    COUNT(*) AS sales_per_year\nFROM\n    \"crmdatabase_92cf\".\"public\".\"silver_vendas\"\nGROUP BY\n    sales_year", "relation_name": "\"crmdatabase_92cf\".\"public\".\"sales_per_year\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-10-03T23:35:14.682355Z", "completed_at": "2024-10-03T23:35:14.689940Z"}, {"name": "execute", "started_at": "2024-10-03T23:35:14.690796Z", "completed_at": "2024-10-03T23:35:16.895402Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 2.218158483505249, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.vendas_dbt.top3_salesperson_quantity", "compiled": true, "compiled_code": "\n\n-- KPI: Os 3 Vendedore com Mais Vendas (em Quantidade)\n-- Encontra o 3 vendedores com maior n\u00famero de vendas.\n\nSELECT\n    email,\n    COUNT(*) AS salesperson_total_sales\nFROM\n    \"crmdatabase_92cf\".\"public\".\"silver_vendas\"\nGROUP BY\n    email\nORDER BY\n    salesperson_total_sales DESC\nLIMIT 3", "relation_name": "\"crmdatabase_92cf\".\"public\".\"top3_salesperson_quantity\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-10-03T23:35:16.908636Z", "completed_at": "2024-10-03T23:35:16.913877Z"}, {"name": "execute", "started_at": "2024-10-03T23:35:16.914781Z", "completed_at": "2024-10-03T23:35:19.093717Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 2.1889355182647705, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.vendas_dbt.top3_salesperson_value", "compiled": true, "compiled_code": "\n\n-- KPI: os 3 Vendedores com Mais Vendas (em Valor)\n-- Encontra os 3 melhores vendedores que geraram os maiores valores de vendas.\n\nSELECT\n    email,\n    SUM(valor) AS salesperson_total_revenue\nFROM\n    \"crmdatabase_92cf\".\"public\".\"silver_vendas\"\nGROUP BY\n    email\nORDER BY\n    salesperson_total_revenue DESC\nLIMIT 3", "relation_name": "\"crmdatabase_92cf\".\"public\".\"top3_salesperson_value\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-10-03T23:35:19.103715Z", "completed_at": "2024-10-03T23:35:19.109161Z"}, {"name": "execute", "started_at": "2024-10-03T23:35:19.110030Z", "completed_at": "2024-10-03T23:35:21.301953Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 2.201961040496826, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.vendas_dbt.total_revenue", "compiled": true, "compiled_code": "\n\n-- KPI: Faturamento Total\n-- Calcula a soma do valor total de todas as vendas.\n\nSELECT\n    SUM(valor) AS total_revenue\nFROM\n    \"crmdatabase_92cf\".\"public\".\"silver_vendas\"", "relation_name": "\"crmdatabase_92cf\".\"public\".\"total_revenue\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-10-03T23:35:21.316996Z", "completed_at": "2024-10-03T23:35:21.322386Z"}, {"name": "execute", "started_at": "2024-10-03T23:35:21.323225Z", "completed_at": "2024-10-03T23:35:23.547570Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 2.235060930252075, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.vendas_dbt.total_sales", "compiled": true, "compiled_code": "\n\n-- KPI: N\u00famero Total de Vendas\n-- Calcula a quantidade total de vendas realizadas.\n\nSELECT\n    COUNT(*) AS total_sales\nFROM\n    \"crmdatabase_92cf\".\"public\".\"silver_vendas\"", "relation_name": "\"crmdatabase_92cf\".\"public\".\"total_sales\""}], "elapsed_time": 52.7082633972168, "args": {"indirect_selection": "eager", "log_level": "info", "source_freshness_run_project_hooks": false, "invocation_command": "dbt run", "partial_parse": true, "quiet": false, "log_path": "/home/jcnok/bootcamps/crm-system/crm-system/vendas_dbt/logs", "project_dir": "/home/jcnok/bootcamps/crm-system/crm-system/vendas_dbt", "introspect": true, "send_anonymous_usage_stats": true, "strict_mode": false, "log_format": "default", "profiles_dir": "/home/jcnok/.dbt", "version_check": true, "print": true, "log_level_file": "debug", "select": [], "favor_state": false, "which": "run", "require_resource_names_without_spaces": false, "macro_debugging": false, "empty": false, "cache_selected_only": false, "static_parser": true, "use_colors_file": true, "printer_width": 80, "populate_cache": true, "defer": false, "use_colors": true, "log_file_max_bytes": 10485760, "show_resource_report": false, "exclude": [], "write_json": true, "enable_legacy_logger": false, "log_format_file": "debug", "partial_parse_file_diff": true, "vars": {}, "require_explicit_package_overrides_for_builtin_materializations": true, "warn_error_options": {"include": [], "exclude": []}}}